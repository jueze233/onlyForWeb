export const ui={showProgress(e){document.getElementById("progressContainer").style.display="block",document.getElementById("progressFill").style.width=e+"%"},hideProgress(){document.getElementById("progressContainer").style.display="none",document.getElementById("progressFill").style.width="0%"},showStatus(e,t){let n=document.getElementById("statusMessage");n&&(n.textContent=e,n.className=`status-message status-${t}`,n.style.display="block")},openModal(e){let t=document.getElementById(e);t&&(t.style.display="flex")},closeModal(e){let t=document.getElementById(e);t&&(t.style.display="none")},setButtonLoading(e,t,n="处理中..."){let o=document.getElementById(e);if(o){if(t&&!o.dataset.originalContent&&(o.dataset.originalContent=o.innerHTML),t){if(o.disabled=!0,o.classList.add("btn-loading"),"convertBtn"===e){let s=document.getElementById("convertIcon"),l=document.getElementById("convertText");s&&l&&(s.innerHTML='<div class="loading"></div>',l.textContent=n)}else o.innerHTML=`<span class="loading"></span> <span>${n}</span>`}else if(o.disabled=!1,o.classList.remove("btn-loading"),"convertBtn"===e){let a=document.getElementById("convertIcon"),i=document.getElementById("convertText");a&&i&&(a.textContent="\uD83D\uDD04",i.textContent="开始转换")}else o.dataset.originalContent&&(o.innerHTML=o.dataset.originalContent,delete o.dataset.originalContent)}},async withButtonLoading(e,t,n="处理中..."){this.setButtonLoading(e,!0,n);try{await t()}finally{this.setButtonLoading(e,!1)}},scrollToElement(e){let t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}};export function initGlobalModalListeners(){window.addEventListener("click",function(e){let t=document.querySelectorAll(".modal");t.forEach(t=>{if(e.target===t){if("costumeModal"===t.id&&window.costumeManager&&window.costumeManager.originalCostumes){window.costumeManager.cancelCostumeChanges();return}ui.closeModal(t.id)}})}),window.addEventListener("keydown",function(e){if("Escape"===e.key){let t=document.querySelectorAll(".modal");t.forEach(e=>{if("none"!==e.style.display){if("costumeModal"===e.id&&window.costumeManager&&window.costumeManager.originalCostumes){window.costumeManager.cancelCostumeChanges();return}ui.closeModal(e.id)}})}})}window.removeConfigItem=function(e){e.parentElement.remove()},window.ui=ui;